<div class="panel panel-default">
{% if page.goal %}
    {% for item in site.data.dashboard.goals %}
         {% if item.goal == page.goal %}
            <a class="sidebar-panel-heading" href="./{{ item.goal }}">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        {{ item.goal }} - {{ item.title }}
                    </h3>
                </div>
            </a>
        {% endif %}
    {% endfor %}

    <div class="list-group">
    {% for indicator in site.indicators %}
        {% if indicator.goal == page.goal %}
            {% assign selected = "" %}
            {% if indicator.subgoal %}
                {% if indicator.subgoal == page.subgoal %}
                    {% assign selected = "active" %}
                {% endif %}
                <a class="list-group-item {{ selected }}" href=".{{ indicator.goal }}">{{ indicator.subgoal }}</a>
            {% endif %}
        {% endif %}
    {% endfor %}
    </div>

{% else %}

    <div class="list-group">


{% for item in site.data.dashboard.goals %}

    {% assign todos = 0 %}
    {% assign doings = 0 %}
    {% assign dones = 0 %}
    {% assign items = 0 %}

    {% assign issues_total = 0 %}
    {% assign todos_percent = 0 %}
    {% assign doings_percent = 0 %}
    {% assign dones_percent = 0 %}

        {% for indicator in site.indicators %}
            {% if indicator.goal == item.goal %}
                {% for dataset in indicator.datasets %}
                    {% assign datasets = datasets | plus:1 %}
                    {% assign todos = todos | plus:dataset.todo %}
                    {% assign doings = doings | plus:dataset.doing %}
                    {% assign dones = dones | plus:dataset.done %}
                {% endfor %}
            {% endif %}
        {% endfor %}

        {% assign issues_total = todos | plus:doings | plus:dones | round: 1 %}

        {% assign todos_percent = todos | divided_by:issues_total | times:100 %}
        {% assign doings_percent = doings | divided_by:issues_total | times:100 %}
        {% assign dones_percent = dones | divided_by:issues_total | times:100 %}


        <a class="list-group-item" href="./{{ item.goal }}.html">
            <span class="badge">{{ items }}</span>
            {{ site.data.bootstrap.label_primary }}{{ item.goal }}{{ site.data.bootstrap.label_end }} {{ item.title }}

            <div class="progress">
              {{ site.data.bootstrap.progress_done }}{{ dones_percent }}{{ site.data.bootstrap.progress_end}}
              {{ site.data.bootstrap.progress_doing }}{{ doings_percent }}{{ site.data.bootstrap.progress_end }}
              {{ site.data.bootstrap.progress_todo }}{{ todos_percent }}{{ site.data.bootstrap.progress_end }}
            </div>

        </a>

{% endfor %}

    </div>

{% endif %}
</div>
